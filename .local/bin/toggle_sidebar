#!/bin/bash

config="$HOME/.config/eww/sidebar/"
lock_file="/tmp/eww_sidebar_open"
screens_resolutions=$(sh "$config/scripts/screen_resolutions")

run_eww() {
	current_desktop=$(awesome-client 'return mouse.screen.index' | cut -d ' ' -f 5)
	monitor=$((current_desktop-1))
	eww -c "$config" open-many \
		sidebar:sidebar \
		quotes:quotes \
		--arg sidebar:screen="$monitor" \
		--arg sidebar:screens_resolutions="$screens_resolutions" \
		--arg quotes:screen="$monitor" \
		--arg quotes:screens_resolutions="$screens_resolutions"
}

if [ ! -f "$lock_file" ]; then
	touch "$lock_file"
	run_eww
else
	rm "$lock_file" &&
	eww -c "$config" close-all
fi
